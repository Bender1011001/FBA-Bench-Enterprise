<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>FBA-Bench | Live Leaderboard</title>

    <meta name="description" content="Live benchmark leaderboard for AI business agents under recession conditions." />
    <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
    <meta name="theme-color" content="#0a0a0a" />
    <link rel="canonical" href="https://fbabench.com/" />
    <link rel="icon" href="favicon.svg" type="image/svg+xml" />
    <meta property="og:site_name" content="FBA-Bench" />
    <meta property="og:title" content="FBA-Bench | Live Leaderboard" />
    <meta property="og:description" content="Live benchmark leaderboard for AI business agents under recession conditions." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://fbabench.com/" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="FBA-Bench | Live Leaderboard" />
    <meta name="twitter:description" content="Live benchmark leaderboard for AI business agents under recession conditions." />
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"FBA-Bench","url":"https://fbabench.com/"}</script>
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&display=swap" rel="stylesheet" />
  </head>
  <body>
    <div class="bg-grid" aria-hidden="true"></div>

    <header class="wrap header">
      <div class="brand">
        <div class="logo">FBA</div>
        <div class="brand-text">
          <div class="title">FBA-Bench</div>
          <div class="sub">Live leaderboard for AI business agents</div>
        </div>
      </div>

      <div class="right">
        <div id="liveBadge" class="badge badge-live hidden">LIVE BENCHMARK RUNNING</div>
        <div class="meta">
          <div class="meta-k">Last updated</div>
          <div id="lastUpdated" class="meta-v">Loading...</div>
        </div>
      </div>
    </header>

    <main class="wrap">
      <section class="hero">
        <h1 id="heroTitle">FBA-Bench Leaderboard</h1>
        <p class="hook">
          <span id="heroHook">Loading benchmark mode...</span>
          <span id="statusLine">Status: awaiting data.</span>
        </p>
        <div class="chips">
          <a class="chip" href="?mode=agentic">agentic</a>
          <a class="chip" href="?mode=prompt">prompt</a>
          <a class="chip" href="api/leaderboard.json" target="_blank" rel="noreferrer">leaderboard.json</a>
          <a class="chip" href="api/live.json" target="_blank" rel="noreferrer">live.json</a>
          <a class="chip" href="docs/">docs</a>
          <a class="chip" href="docs/#sponsorship.md">sponsor</a>
          <a class="chip" href="contact.html">message me</a>
          <a class="chip" href="https://github.com/Bender1011001/FBA-Bench" target="_blank" rel="noreferrer">github</a>
        </div>
      </section>

      <section class="support">
        <div class="support-content">
          <h2>Support the Research</h2>
          <p>
            The benchmark is expensive to run (tokens + infra). If you want the leaderboard updated more often or want a
            specific model evaluated, consider sponsoring compute credits or a run.
          </p>
          <div class="crypto-grid">
            <div class="crypto-card">
              <div class="crypto-label">Monero (XMR)</div>
              <code class="crypto-addr">83YhKW5PzCSdkeT6fQ6g5kZ7159AoXDqjCS835rcdPkuh4AEd52t79vDR9kff7A6tT46uzAzYZku8dcarqvJH1v5SQ6emDv</code>
            </div>
            <div class="crypto-card">
              <div class="crypto-label">Bitcoin (BTC)</div>
              <code class="crypto-addr">bc1qg607xtepk96tgn94lewgfe68gn0r3m4x6nz7n5</code>
            </div>
            <div class="crypto-card">
              <div class="crypto-label">Ethereum (ETH / ERC-20)</div>
              <code class="crypto-addr">0x8db7b843417D4744b8d81395aCDe817cE0f4A32B</code>
            </div>
            <div class="crypto-card">
              <div class="crypto-label">Litecoin (LTC)</div>
              <code class="crypto-addr">ltc1q63j9d7l73t6k5e6etwyxfgd4kghf6ssj6cuv5e</code>
            </div>
          </div>
        </div>
      </section>

      <section class="cards">
        <div class="card">

          <div class="card-k">Run</div>
          <div id="runId" class="card-v">--</div>
        </div>
        <div class="card">
          <div class="card-k">Tier</div>
          <div id="tier" class="card-v">--</div>
        </div>
        <div class="card">
          <div class="card-k" id="metricK1">Avg profit</div>
          <div id="metricV1" class="card-v">--</div>
        </div>
        <div class="card">
          <div class="card-k" id="metricK2">Avg ROI</div>
          <div id="metricV2" class="card-v">--</div>
        </div>
        <div class="card">
          <div class="card-k">Tokens</div>
          <div id="totalTokens" class="card-v">--</div>
        </div>
      </section>

      <section class="panel">
        <div class="panel-h">
          <div class="panel-title">Global Leaderboard</div>
          <div id="panelNote" class="panel-note">Class of 2026 models, Tier-2 prompts.</div>
        </div>

        <div class="table-wrap">
          <table class="table">
            <thead>
              <tr>
                <th>Rank</th>
                <th>Model</th>
                <th>Provider</th>
                <th id="colK1">Net Profit</th>
                <th id="colK2">ROI</th>
                <th id="colK3">Calls</th>
                <th id="colK4">Avg Call</th>
                <th>Tokens</th>
              </tr>
            </thead>
            <tbody id="rows">
              <tr><td colspan="8" class="muted">Loading...</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <footer class="footer">
        <div class="footer-links">
          <a href="docs/#terms.md">Terms</a>
          <a href="docs/#privacy.md">Privacy</a>
          <a href="docs/#disclaimer.md">Disclaimer</a>
          <a href="docs/#sponsorship.md">Sponsor</a>
          <a href="contact.html">Message me</a>
        </div>
        <div>FBA-Bench. Built for the era of agentic AI.</div>
        <div class="muted">If the leaderboard looks stale, the publisher is not running or results are not deployed.</div>
      </footer>
    </main>

    <script>
      async function fetchJson(url) {
        const res = await fetch(url, { cache: "no-store" });
        if (!res.ok) throw new Error(url + " " + res.status);
        return await res.json();
      }

      function fmtPct(x) {
        if (typeof x !== "number") return "--";
        return x.toFixed(1) + "%";
      }

      function fmtPctFraction(x) {
        if (typeof x !== "number") return "--";
        return (x * 100).toFixed(1) + "%";
      }

      function fmtNum(x) {
        if (typeof x !== "number") return "--";
        return x.toLocaleString(undefined, { maximumFractionDigits: 3 });
      }

      function fmtSec(x) {
        if (typeof x !== "number") return "--";
        return x.toFixed(2) + "s";
      }

      function fmtMoney(x) {
        if (typeof x !== "number") return "--";
        const sign = x >= 0 ? "+" : "-";
        const abs = Math.abs(x);
        return sign + "$" + abs.toLocaleString(undefined, { maximumFractionDigits: 2 });
      }

      function profitClass(x) {
        if (typeof x !== "number") return "q-neutral";
        if (x > 0.01) return "q-good";
        if (x < -0.01) return "q-bad";
        return "q-warn";
      }

      function applyModeUI(mode) {
        const heroTitle = document.getElementById("heroTitle");
        const heroHook = document.getElementById("heroHook");
        const panelNote = document.getElementById("panelNote");
        const colK1 = document.getElementById("colK1");
        const colK2 = document.getElementById("colK2");
        const colK3 = document.getElementById("colK3");
        const colK4 = document.getElementById("colK4");

        if (mode === "prompt") {
          if (heroTitle) heroTitle.textContent = "Tier-2 Prompt Battery (Fast)";
          if (heroHook) heroHook.textContent = "Scoring structured decision quality and format reliability. No tools. No memory. No scaffolding.";
          if (panelNote) panelNote.textContent = "Tier-2 prompt suite (cheap + reproducible).";
          if (colK1) colK1.textContent = "Quality";
          if (colK2) colK2.textContent = "Success";
          if (colK3) colK3.textContent = "Avg RT";
          if (colK4) colK4.textContent = "Errors";
        } else {
          if (heroTitle) heroTitle.textContent = "The Bankruptcy Test (Agentic)";
          if (heroHook) heroHook.textContent = "Long-horizon e-commerce sim under shocks: can the model stay solvent across months of decisions?";
          if (panelNote) panelNote.textContent = "Tick-based simulation, scored by profit and survival under compounding consequences.";
          if (colK1) colK1.textContent = "Net Profit";
          if (colK2) colK2.textContent = "ROI";
          if (colK3) colK3.textContent = "Calls";
          if (colK4) colK4.textContent = "Avg Call";
        }
      }

      function render(lb, live) {
        const rankings = (lb && lb.rankings) ? lb.rankings : [];
        const mode = (lb && typeof lb.metric_mode === "string") ? lb.metric_mode : "agentic";

        applyModeUI(mode);

        document.getElementById("lastUpdated").textContent = (lb && lb.generated_at) ? lb.generated_at : "Unknown";
        document.getElementById("runId").textContent = (lb && lb.active_run && lb.active_run.run_id) ? lb.active_run.run_id : "--";
        document.getElementById("tier").textContent = (lb && lb.active_run && lb.active_run.tier) ? lb.active_run.tier : "--";
        document.getElementById("totalTokens").textContent = (lb && lb.summary) ? fmtNum(lb.summary.total_tokens) : "--";

        // Metric cards (switch labels by benchmark mode).
        const k1 = document.getElementById("metricK1");
        const v1 = document.getElementById("metricV1");
        const k2 = document.getElementById("metricK2");
        const v2 = document.getElementById("metricV2");

        if (mode === "prompt") {
          k1.textContent = "Avg quality";
          k2.textContent = "Avg success";
          v1.textContent = (lb && lb.summary && typeof lb.summary.avg_quality_score === "number")
            ? fmtNum(lb.summary.avg_quality_score)
            : "--";
          v2.textContent = (lb && lb.summary && typeof lb.summary.avg_success_rate === "number")
            ? fmtPctFraction(lb.summary.avg_success_rate)
            : "--";
        } else {
          k1.textContent = "Avg profit";
          k2.textContent = "Avg ROI";
          v1.textContent = (lb && lb.summary && typeof lb.summary.avg_total_profit === "number")
            ? fmtMoney(lb.summary.avg_total_profit)
            : "--";
          v2.textContent = (lb && lb.summary && typeof lb.summary.avg_roi_pct === "number")
            ? fmtPct(lb.summary.avg_roi_pct)
            : "--";
        }

        const active = !!(live && live.active);
        const badge = document.getElementById("liveBadge");
        if (active) badge.classList.remove("hidden");
        else badge.classList.add("hidden");

        const statusLine = document.getElementById("statusLine");
        if (live && typeof live.status === "string") {
          statusLine.textContent = "Current Status: " + live.status + " (" + (live.completed || 0) + "/" + (live.total || 0) + ")";
        } else {
          statusLine.textContent = "Status: awaiting data.";
        }

        const rows = document.getElementById("rows");
        if (!rankings.length) {
          rows.innerHTML = '<tr><td colspan="8" class="muted">No data yet.</td></tr>';
          return;
        }

        rows.innerHTML = rankings.map(r => {
          if (mode === "prompt") {
            const q = (typeof r.quality_score === "number") ? r.quality_score : 0;
            const sr = (typeof r.success_rate === "number") ? r.success_rate : 0;
            const rt = (typeof r.avg_response_time === "number") ? r.avg_response_time : null;
            const ec = (typeof r.error_count === "number") ? r.error_count : ((r.success === false) ? 1 : 0);
            return `
              <tr>
                <td><span class="rank">${r.rank}</span></td>
                <td class="mono">${(r.model_slug || r.model_name || "unknown")}</td>
                <td>${(r.provider || "unknown")}</td>
                <td><span class="pill ${profitClass(q - 0.85)}">${fmtNum(q)}</span></td>
                <td><span class="pill ${sr >= 1.0 ? "q-good" : sr >= 0.8 ? "q-warn" : "q-bad"}">${fmtPctFraction(sr)}</span></td>
                <td class="mono">${fmtSec(rt)}</td>
                <td><span class="pill ${ec > 0 ? "q-bad" : "q-good"}">${fmtNum(ec)}</span></td>
                <td class="mono">${fmtNum(r.total_tokens)}</td>
              </tr>
            `;
          }

          const p = (typeof r.total_profit === "number") ? r.total_profit : null;
          const roi = (typeof r.roi_pct === "number") ? r.roi_pct : null;
          const calls = (typeof r.llm_calls === "number") ? r.llm_calls : null;
          const avgCall = (typeof r.avg_call_seconds === "number") ? r.avg_call_seconds : null;
          const tokens = (typeof r.total_tokens === "number") ? r.total_tokens : null;
          return `
            <tr>
              <td><span class="rank">${r.rank}</span></td>
              <td class="mono">${(r.model_slug || r.model_name || "unknown")}</td>
              <td>${(r.provider || "unknown")}</td>
              <td><span class="pill ${profitClass(p)}">${fmtMoney(p)}</span></td>
              <td><span class="pill ${profitClass(roi)}">${roi === null ? "--" : fmtPct(roi)}</span></td>
              <td class="mono">${calls === null ? "--" : fmtNum(calls)}</td>
              <td>${fmtSec(avgCall)}</td>
              <td class="mono">${fmtNum(tokens)}</td>
            </tr>
          `;
        }).join("");
      }

      function leaderboardPath() {
        const qs = new URLSearchParams(window.location.search);
        const m = (qs.get("mode") || "").toLowerCase();
        if (m === "prompt") return "api/leaderboard_prompt.json";
        if (m === "agentic") return "api/leaderboard_agentic.json";
        return "api/leaderboard.json";
      }

      async function tick() {
        try {
          const lbPath = leaderboardPath();
          const [lb, live] = await Promise.all([
            fetchJson(lbPath).catch(() => fetchJson("api/leaderboard.json")),
            fetchJson("api/live.json").catch(() => null),
          ]);
          render(lb, live);
        } catch (e) {
          const rows = document.getElementById("rows");
          rows.innerHTML = '<tr><td colspan="8" class="muted">Failed to load leaderboard.json</td></tr>';
        }
      }

      tick();
      setInterval(tick, 10000);
    </script>
  </body>
</html>
